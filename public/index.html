const express = require('express');
const { Client, GatewayIntentBits } = require('discord.js');
const app = express();
app.use(express.json());

app.post('/start', async (req, res) => {
    const { token } = req.body;
    if(!token) return res.json({ message: 'لا يوجد توكن!' });

    try {
        const client = new Client({ intents: [GatewayIntentBits.Guilds, GatewayIntentBits.GuildMessages, GatewayIntentBits.MessageContent] });
        client.on('ready', () => {
            console.log(`بوت شغال: ${client.user.tag}`);
        });
        await client.login(token);
        res.json({ message: 'تم تشغيل البوت بنجاح!' });
    } catch(e) {
        res.json({ message: 'فشل تشغيل البوت. تحقق من التوكن.' });
    }
});

app.listen(process.env.PORT || 3000, () => console.log('Server running'));
