<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>لوحة بوتات ديسكورد الذكية</title>
<style>
body { background: #111; color: #0ff; font-family: 'Segoe UI', sans-serif; margin:0; padding:20px; }
h1{text-align:center;text-shadow:0 0 10px #0ff;}
.section{background:#222;margin:15px auto;padding:15px;border-radius:10px;box-shadow:0 0 10px #0ff33;transition:0.2s;}
.section:hover{transform:translateY(-3px);box-shadow:0 0 15px #0ff;}
input,textarea,button{display:block;width:100%;padding:10px;margin:5px 0;border-radius:5px;border:none;font-size:14px;}
input,textarea{background:#111;color:#0ff;border:1px solid #0ff;}
button{background:linear-gradient(90deg,#0ff,#00aaff);color:#000;font-weight:bold;cursor:pointer;transition:0.2s;}
button:hover{transform:scale(1.05);box-shadow:0 0 10px #0ff;}
.bot{margin-top:10px;}
.bot-header{display:flex;justify-content:space-between;align-items:center;padding-bottom:5px;border-bottom:1px solid #0ff;}
.bot-body{padding-top:10px;}
pre{background:#333;padding:10px;border-radius:5px;overflow-x:auto;margin-top:10px;}
</style>
</head>
<body>
<h1>لوحة بوتات ديسكورد الذكية</h1>

<div class="section">
  <input id="botName" placeholder="اسم البوت"/>
  <input id="botToken" placeholder="توكن البوت"/>
  <button onclick="addBotUI()">إضافة بوت</button>
</div>

<div id="botList"></div>

<script>
async function addBotUI(){
  const name=document.getElementById('botName').value;
  const token=document.getElementById('botToken').value;
  const res=await fetch('/add-bot',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({name,token})});
  const data=await res.json();
  if(data.success) location.reload();
  else alert(data.msg);
}

async function toggle(token){
  await fetch('/toggle-bot',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({token})});
  loadBots();
}

async function generate(i){
  const input=document.getElementById('input'+i).value;
  const res=await fetch('/generate',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({text:input})});
  const data=await res.json();
  document.getElementById('result'+i).textContent=data.code;
}

async function uploadFile(i){
  const file=document.getElementById('file'+i).files[0];
  const botName=document.getElementById('botName'+i).value;
  const fd=new FormData();
  fd.append('file',file);
  fd.append('botName',botName);
  await fetch('/upload',{method:'POST',body:fd});
  alert('تم رفع الملف!');
}

async function loadBots(){
  const res=await fetch('/get-bots');
  const data=await res.json();
  const container=document.getElementById('botList');
  container.innerHTML="";
  data.bots.forEach((b,i)=>{
    const div=document.createElement('div');
    div.className='section bot';
    div.innerHTML=`
      <div class="bot-header">
        <h3>${b.name} - ${b.online?"أونلاين ✅":"أوفلاين ❌"}</h3>
        <button onclick="toggle('${b.name}')">${b.online?"إيقاف":"تشغيل"}</button>
      </div>
      <div class="bot-body">
        <textarea id="input${i}" placeholder="اكتب أي شيء"></textarea>
        <button onclick="generate(${i})">توليد كود</button>
        <input type="file" id="file${i}" onchange="uploadFile(${i})"/>
        <pre id="result${i}"></pre>
      </div>
    `;
    container.appendChild(div);
  });
}

loadBots();
</script>
</body>
</html>
